<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Home</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/style.css}" type="text/css"/>
</head>
<body>
<h1>Book Details</h1>

<!-- Book Details -->
<div>
    <h2 th:text="${book.title}"></h2>
    <p><strong>Description:</strong> <span th:text="${book.description}"></span></p>
    <p><strong>Average Rating:</strong> <span th:text="${averageRating}"></span> stars</p>
</div>

<!-- Add Comment Form -->
<h3>Leave a Comment:</h3>
<form action="#" th:action="@{/view/books/{id}/comments(id=${book.id})}" method="post">
    <label for="userName">Name:</label>
    <input type="text" id="userName" name="userName" required>
    <label for="text">Comment:</label>
    <textarea id="text" name="text" required></textarea>
    <button type="submit">Add Comment</button>
</form>

<hr>

<!-- Add Rating Form -->
<h3>Rate this Book:</h3>
<form action="#" th:action="@{/view/books/{id}/ratings(id=${book.id})}" method="post">
    <label for="stars">Rating (1 to 5):</label>
    <input type="number" id="stars" name="stars" min="1" max="5" required>
    <button type="submit">Submit Rating</button>
</form>

<hr>

<!-- Display Comments -->
<h3>Comments:</h3>
<div th:if="${#lists.isEmpty(book.comments)}">
    <p>No comments yet.</p>
</div>
<div th:each="comment : ${book.comments}">
    <p><strong th:text="${comment.userName}"></strong>: <span th:text="${comment.text}"></span></p>
</div>

<a href="/">Back to Books</a>
</body>
</html>